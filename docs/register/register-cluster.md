---
title: Register Cluster
description: Sveltos comes with support to automatically discover ClusterAPI powered clusters. Any other cluster (GKE for instance) can easily be registered with Sveltos.
tags:
    - Kubernetes
    - add-ons
    - helm
    - clusterapi
    - multi-tenancy
authors:
    - Gianluca Mardente
---
Sveltos comes with support to automatically discover [ClusterAPI](https://github.com/kubernetes-sigs/cluster-api) powered clusters. If Sveltos is deployed in a management cluster with ClusterAPI (CAPI), no further action is required for Sveltos to manage add-ons on CAPI-powered clusters. Sveltos will watch for *clusters.cluster.x-k8s.io"* instances and program those accordingly.

Other clusters (on-prem, Cloud) can registered with Sveltos easily. Afterwards, Sveltos can [manage Kubernetes add-ons](../addons/addons.md) on all the clusters seamlessly.

## Register Cluster

This guide walks through registering an existing Kubernetes cluster with Sveltos for management. It is recommended, but not required, to use the [sveltosctl](https://github.com/projectsveltos/sveltosctl "Sveltos CLI") to register a cluster.

If your kubeconfig has multiple contexts, and the default context points to the management cluster, use the __--fleet-cluster-context__ option. 
Set it to the name of the context that points to the cluster you want to register. Run the command like this:

```
sveltosctl register cluster --namespace=<namespace> --cluster=<cluster name> --fleet-cluster-context=<context name> --labels=key1=value1,key2=value2
```

This single command will generate a kubeconfig file and register your cluster with Sveltos.

Otherwise follow those steps:

1. Generate kubeconfig: use the `sveltosctl generate kubeconfig` command while pointing it to the cluster you want Sveltos to manage. This command will create a ServiceAccount with cluster-admin permissions and generate the kubeconfig based on it. [^1]
2. Register the Cluster: Use the `sveltosctl register cluster` command while pointing it to the Sveltos management cluster. Provide the following options:
    - `--namespace=<namespace>`: Namespace in the management cluster where Sveltos will store information about the registered cluster.
    - `--cluster=<cluster name>`: A chosen name to identify the registered cluster within Sveltos.
    - `--kubeconfig=<path to file with Kubeconfig>`: Path to the kubeconfig file generated in step 1.
    - `--labels=<key1=value1,key2=value2>` (Optional): Comma-separated key-value pairs to define labels for the registered cluster (e.g., --labels=environment=production,tier=backend).


### Example

Pointing to the cluster to be managed (Generate kubeconfig with ServiceAccount creation):

```sveltosctl generate kubeconfig --create > ~/.kube/prod-cluster.config```

Pointing to the management cluster (Register the cluster):

```
sveltosctl register cluster \
    --namespace=monitoring \
    --cluster=prod-cluster \
    --kubeconfig=~/.kube/prod-cluster.config \
    --labels=environment=production,tier=backend
```

This example registers a cluster (i.e, creates a SveltosCluster instance) named *prod-cluster* in the *monitoring* namespace with labels "environment=production" and "tier=backend".

If later on you want to change the labels assigned to this cluster

```kubectl edit sveltoscluster prod-cluster -n monitoring``` 

Remember, this command assumes you have kubectl configured to access the Sveltos management cluster.

## Register Civo Cluster
If you use [Civo Cloud](https://www.civo.com), simply download the cluster Kubeconfig and perform the below.

```
$ sveltosctl register cluster --namespace=<namespace> --cluster=<cluster name> \
    --kubeconfig=<path to file with Kubeconfig>
```

## Register GKE Cluster

1. Pointing to GKE cluster, run *sveltosctl generate kubeconfig --create --expirationSeconds=86400*
2. Run *sveltosctl register cluster* command pointing it to the kubeconfig file generated by the step above.

**Please note:** Step #1 is giving Sveltos cluster-admin privileges (that is done because we do not know in advance which add-ons you want Sveltos to deploy). You might choose to give Sveltos fewer privileges. Just keep in mind that it needs enough privileges to deploy the add-ons you request to deploy.

## Register RKE2 Cluster
If you use Rancher's next-generation Kubernetes distribution [RKE2](https://docs.rke2.io/), you will only need to download the kubeconfig either from the Rancher UI under the Cluster Management section or via SSH into the RKE2 Cluster and under the */etc/rancher/rke2/rke2.yaml* directory. Run the below command.

```
$ sveltosctl register cluster --namespace=<namespace> --cluster=<cluster name> \
    --kubeconfig=<path to file with Kubeconfig>
```

[^1]: **Please note:** As an alternative to generate kubeconfig have a look at the [script: get-kubeconfig.sh](https://raw.githubusercontent.com/gianlucam76/scripts/master/get-kubeconfig.sh). Read the script comments to get more clarity on the use and expected outcomes. This script was developed by [Gravitational Teleport](https://github.com/gravitational/teleport/blob/master/examples/k8s-auth/get-kubeconfig.sh). We simply slightly modified to fit Sveltos use case.
